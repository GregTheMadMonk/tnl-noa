#!/bin/bash

CPUS=`grep -c processor /proc/cpuinfo`

echo "Building TNL using $CPUS processors."

if [ ! -d Debug ];
then
   mkdir Debug
fi
if [ ! -d Release ];
then
   mkdir Release
fi

cd Debug
cmake .. -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=${HOME}/local -DCUDA_ARCHITECTURE=2.0 -DWITH_CUDA=yes
make -j${CPUS} #VERBOSE=1
make -j${CPUS} test
make -j${CPUS} install

cd ../Release
cmake .. -DCMAKE_INSTALL_PREFIX=${HOME}/local -DCUDA_ARCHITECTURE=2.0 -DWITH_CUDA=yes
make -j${CPUS}
make -j${CPUS} test
make -j${CPUS} install
